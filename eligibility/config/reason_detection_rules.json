{
  "version": "1.0",
  "file_type": "REASON_DETECTION_RULES",
  "description": "Rules for extracting exclusion reasons from a Reasons File row deterministically.",
  "global_extraction_policy": {
    "extract_all_checks_with_value": "Exclude",
    "also_extract_recency_check_when_value": "N",
    "multi_reason_output": true,
    "ignore_fields": ["Normalized_Mean"]
  },
  "reasons": [
    {
      "reason_code": "JOINT_ACCOUNT_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "Joint_Check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["Joint_Check", "JOINT_ACCOUNT"],
      "facts_builder": {
        "type": "simple",
        "facts": [
          "Account is a joint account (JOINT_ACCOUNT=Y)."
        ]
      }
    },
    {
      "reason_code": "AVERAGE_BALANCE_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "Average_Bal_check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["Average_Bal_check"],
      "facts_builder": {
        "type": "simple",
        "facts": [
          "Customer failed the Average Balance requirement."
        ]
      }
    },
    {
      "reason_code": "DPD_ARREARS_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "DPD_Arrears_Check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": [
        "DPD_Arrears_Check",
        "Arrears_Days",
        "Credit_Card_OD_Days",
        "DPD_Days"
      ],
      "required_facts": [
        "arrears_days",
        "credit_card_od_days",
        "dpd_days",
        "max_dpd_driver",
        "driver_source"
      ],
      "facts_builder": {
        "type": "max_of_numeric_fields_with_evidence",
        "fields": ["Arrears_Days", "Credit_Card_OD_Days", "DPD_Days"],
        "threshold_days": 3,
        "fact_templates": [
          "Customer had DPD/arrears greater than 3 days.",
          "Loan arrears days: {arrears_days}. Credit card OD days: {credit_card_od_days}. Overdraft DPD days: {dpd_days}. DPD driver (max): {max_dpd_driver} days ({driver_source})."
        ]
      }
    },
    {
      "reason_code": "ELMA_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "Elma_check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["Elma_check"],
      "facts_builder": {
        "type": "simple",
        "facts": [
          "Customer failed ELMA/mobile banking/one-account eligibility check."
        ]
      }
    },
    {
      "reason_code": "MANDATE_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "Mandates_Check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["Mandates_Check", "Mandate"],
      "facts_builder": {
        "type": "simple",
        "facts": [
          "Account mandate/signing authority is not in the allowed sole-signing formats."
        ]
      }
    },
    {
      "reason_code": "CLASSIFICATION_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "Classification_Check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["Classification_Check", "CLASSIFICATION"],
      "required_facts": ["classification"],
      "facts_builder": {
        "type": "simple_with_evidence",
        "fact_templates": [
          "Customer risk classification is below the minimum required level (A5).",
          "Observed classification: {classification}."
        ]
      }
    },
    {
      "reason_code": "LINKED_BASE_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "Linked_Base_Check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["Linked_Base_Check", "LINKED_BASE", "LINKED_BASE_CLASSIFICATION"],
      "required_facts": [
        "linked_base",
        "linked_base_classification"
      ],
      "facts_builder": {
        "type": "simple_with_evidence",
        "fact_templates": [
          "A linked base has a classification below A5, causing exclusion.",
          "Linked base: {linked_base}. Linked base classification: {linked_base_classification}."
        ]
      }
    },
    {
      "reason_code": "CUSTOMER_VINTAGE_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "customer_vintage_Check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["customer_vintage_Check", "customer_vintage_Months"],
      "required_facts": ["customer_vintage_Months"],
      "facts_builder": {
        "type": "simple_with_evidence",
        "fact_templates": [
          "Customer has not banked long enough (minimum required is 7 months).",
          "Observed customer vintage: {customer_vintage_Months} months."
        ]
      }
    },
    {
      "reason_code": "DORMANCY_INACTIVE_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "Active_Inactive_Check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["Active_Inactive_Check", "dormancy_status"],
      "facts_builder": {
        "type": "simple",
        "facts": [
          "Account is dormant or inactive due to low activity."
        ]
      }
    },
    {
      "reason_code": "TURNOVER_EXCLUSION",
      "trigger": {
        "type": "check_equals",
        "check_column": "Turnover_Check",
        "trigger_value": "Exclude"
      },
      "evidence_columns": ["Turnover_Check"],
      "facts_builder": {
        "type": "simple",
        "facts": [
          "Customer does not have sufficient banking activity in at least 5 out of 6 months."
        ]
      }
    },
    {
      "reason_code": "RECENCY_EXCLUSION",
      "trigger": {
        "type": "check_special_equals",
        "check_column": "Recency_Check",
        "trigger_value": "N"
      },
      "evidence_columns": ["Recency_Check"],
      "facts_builder": {
        "type": "simple",
        "facts": [
          "Customer has inconsistent recent banking patterns (amounts and/or frequency)."
        ]
      }
    }
  ]
}
